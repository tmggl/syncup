<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Add New Project</title>
        <style>
            /* âœ… Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
            * {
                box-sizing: border-box;
                font-family: 'Segoe UI', sans-serif;
                margin: 0;
                padding: 0;
            }
    
            body {
                background: #f8f9fa;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 15px;
            }
    
            /* âœ… ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
            .modal {
                background: white;
                width: 100%;
                max-width: 400px;  /* â¬…ï¸ ØªØµØºÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ */
                padding: 15px;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ */
                border-radius: 12px;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­ÙˆØ§Ù */
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
                margin-top: 50px;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
            }
    
            h2 {
                text-align: center;
                color: #2c3e50;
                font-size: 1.3rem;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
                margin-bottom: 1rem;
                font-weight: 600;
            }
    
            /* âœ… ØªØµØºÙŠØ± Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ù…ÙŠØ§Øª */
            .form-group {
                margin-bottom: 1rem;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„ */
            }
    
            label {
                display: block;
                font-size: 0.8rem;  /* â¬…ï¸ ØªØµØºÙŠØ± Ø§Ù„Ù†ØµÙˆØµ */
                color: #4a5568;
                margin-bottom: 0.3rem;
                font-weight: 500;
            }
    
            input, 
            select, 
            textarea {
                width: 100%;
                padding: 0.6rem;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ */
                font-size: 0.8rem;  /* â¬…ï¸ ØªØµØºÙŠØ± Ø§Ù„Ù†Øµ */
                border-radius: 6px;
                border: 1px solid #e2e8f0;
                background: #f8fafc;
            }
    
            input:focus, 
            select:focus, 
            textarea:focus {
                border-color: #6a0dad;
                box-shadow: 0 0 0 3px rgba(106, 13, 173, 0.15);
                outline: none;
            }
    
            textarea {
                min-height: 80px;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø·ÙˆÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ */
                resize: vertical;
            }
    
            /* âœ… ØªØµÙ…ÙŠÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª */
            .file-upload {
                border: 2px dashed #cbd5e0;
                border-radius: 6px;
                padding: 1rem;
                text-align: center;
                cursor: pointer;
                transition: 0.3s;
                background: #f8fafc;
            }
    
            .file-upload:hover {
                border-color: #6a0dad;
                background: rgba(106, 13, 173, 0.05);
            }
    
            .file-preview {
                margin-top: 0.5rem;
                font-size: 0.75rem;
                color: #4a5568;
            }
    
            /* âœ… ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® */
            .date-container {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 0.8rem;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø¨ÙŠÙ† Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® */
                margin-bottom: 1rem;
            }
    
            /* âœ… ØªØµØºÙŠØ± Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ */
/* âœ… ØªÙ†Ø³ÙŠÙ‚ ÙƒØ±ÙˆØª Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
/* âœ… ØªÙ†Ø³ÙŠÙ‚ ÙƒØ±ÙˆØª Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
.color-selection {
    display: flex;
    justify-content: center;
    gap: 0.5rem; /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
    flex-wrap: nowrap;
    margin-top: 0.5rem;
}

/* âœ… ØªÙ†Ø³ÙŠÙ‚ ÙƒÙ„ ÙƒØ±Øª */
.color-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    padding: 0.3rem; /* â¬…ï¸ ØªØµØºÙŠØ± Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ */
    border: 2px solid transparent;
    border-radius: 8px;
    text-align: center;
    transition: all 0.3s ease-in-out;
    width: 50px; /* â¬…ï¸ ØªØµØºÙŠØ± Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ±Øª */
}

/* âœ… ØªØµØºÙŠØ± Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ù…Ù„ÙˆÙ†Ø© */
.color-circle {
    width: 24px; /* â¬…ï¸ ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© */
    height: 24px;
    border-radius: 50%;
    border: 2px solid rgba(0, 0, 0, 0.2);
    transition: all 0.2s ease-in-out;
}

/* âœ… ØªØµØºÙŠØ± Ø§Ù„Ù†Øµ Ø£Ø³ÙÙ„ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© */
.color-card span {
    margin-top: 0.3rem; /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© ÙˆØ§Ù„Ù†Øµ */
    font-size: 0.7rem; /* â¬…ï¸ ØªØµØºÙŠØ± Ø§Ù„Ù†Øµ */
    font-weight: bold;
    color: #333;
}

/* âœ… Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± */
.color-card input {
    display: none;
}

/* âœ… ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ */
.color-card input:checked + .color-circle {
    border: 2px solid black;
    transform: scale(1.1);
}
    
            /* âœ… ØªØµØºÙŠØ± Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
            .buttons {
                display: flex;
                gap: 0.8rem;
                margin-top: 1rem;
            }
    
            .btn {
                flex: 1;
                padding: 0.6rem 1rem;  /* â¬…ï¸ ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
                font-size: 0.8rem;  /* â¬…ï¸ ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· */
                border-radius: 6px;
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: 0.3s;
            }
    
            .cancel {
                background: #f1f5f9;
                color: #64748b;
            }
    
            .cancel:hover {
                background: #e2e8f0;
            }
    
            .add {
                background: linear-gradient(135deg, #6a0dad, #4b0082);
                color: white;
                box-shadow: 0 4px 6px rgba(106, 13, 173, 0.2);
            }
    
            .add:hover {
                transform: translateY(-1px);
                box-shadow: 0 6px 12px rgba(106, 13, 173, 0.25);
            }
    
            /* âœ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ */
            @media (max-width: 480px) {
                .modal {
                    padding: 12px;
                    max-width: 90%;
                }
    
                h2 {
                    font-size: 1.2rem;
                }
    
                .btn {
                    font-size: 0.75rem;
                    padding: 0.5rem;
                }
            }
        </style>
    </head>
<body>
    {% include 'navbar.html' %}
    
    <div class="modal">
        <h2>â• Add New Project</h2>

        <form method="POST" enctype="multipart/form-data" id="createProjectForm">
            {% csrf_token %}
            
            <div class="form-group">
                <label>Project Type</label>
                {{ form.category }}
            </div>

            <div class="form-group">
                <label>Project Logo</label>
                <div class="file-upload">
                    <input type="file" id="id_logo" name="logo" class="file-input" accept="image/*">
                    <span>ğŸ“ Click to upload logo</span>
                </div>
                <div id="logo-preview" class="file-preview"></div>
                <div id="logo-error" class="error-message" style="color: red; font-size: 0.85rem; margin-top: 5px; display: none;"></div>
            </div>
            
            <div class="form-group">
                <label>Project Name</label>
                {{ form.name }}
            </div>

            <div class="form-group">
                <label>Description</label>
                {{ form.description }}
            </div>

            <div class="form-group">
                <label>Attachments</label>
                <div class="file-upload">
                    <input type="file" id="id_attachments" name="attachments" multiple>
                    <span>ğŸ“ Click to add attachments</span>
                </div>
                <div id="attachments-preview" class="file-preview"></div>
            </div>

            <div class="date-container">
                <div class="form-group">
                    <label>Start Date</label>
                    <input type="date" id="id_start_date" name="start_date" required>
                </div>
                
                <div class="form-group">
                    <label>End Date</label>
                    <input type="date" id="id_end_date" name="end_date" required>
                </div>
            </div>

            <div class="form-group">
                <label>Project Color</label>
                <div class="color-selection">
                    <label class="color-card">
                        <input type="radio" name="project_color" value="purple" required>
                        <div class="color-circle" style="background: #6a0dad;"></div>
                        <span>Purple</span>
                    </label>
                    <label class="color-card">
                        <input type="radio" name="project_color" value="red">
                        <div class="color-circle" style="background: #ff4757;"></div>
                        <span>Red</span>
                    </label>
                    <label class="color-card">
                        <input type="radio" name="project_color" value="blue">
                        <div class="color-circle" style="background: #1e90ff;"></div>
                        <span>Blue</span>
                    </label>
                    <label class="color-card">
                        <input type="radio" name="project_color" value="green">
                        <div class="color-circle" style="background: #2ed573;"></div>
                        <span>Green</span>
                    </label>
                    <label class="color-card">
                        <input type="radio" name="project_color" value="orange">
                        <div class="color-circle" style="background: #ffa502;"></div>
                        <span>Orange</span>
                    </label>
                    <label class="color-card">
                        <input type="radio" name="project_color" value="pink">
                        <div class="color-circle" style="background: #ff6b81;"></div>
                        <span>Pink</span>
                    </label>
                </div>
            </div>
            
            <div class="buttons">
                <button type="button" class="btn cancel" onclick="closeModal()">Cancel</button>
                <button type="submit" class="btn add">Create Project</button>
            </div>
        </form>
    </div>

    <script>
        // âœ… ÙˆØ¸ÙŠÙØ© Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
        function closeModal() {
            window.location.replace("{% url 'projects_list' %}");
        }
    
        document.addEventListener("DOMContentLoaded", function() {
            initializeColorSelection();
            initializeDateRestrictions();
            initializeFileUploadListeners();
            initializeFormSubmission();
        });
    
        // âœ… ØªØ­Ø¯ÙŠØ« Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆÙ† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§
        function initializeColorSelection() {
            let colorCards = document.querySelectorAll(".color-card input");
            colorCards.forEach(card => {
                card.addEventListener("change", function() {
                    document.querySelectorAll(".color-circle").forEach(circle => {
                        circle.style.border = "2px solid rgba(0, 0, 0, 0.2)";
                    });
                    this.nextElementSibling.style.border = "2px solid black";
                });
            });
        }
    
        // âœ… ØªÙ‚ÙŠÙŠØ¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ù„Ù…Ù†Ø¹ ØªØ­Ø¯ÙŠØ¯ ØªÙˆØ§Ø±ÙŠØ® Ø³Ø§Ø¨Ù‚Ø©
        function initializeDateRestrictions() {
            let today = new Date().toISOString().split("T")[0];
            let startDateInput = document.getElementById('id_start_date');
            let endDateInput = document.getElementById('id_end_date');
    
            if (startDateInput) startDateInput.setAttribute("min", today);
            if (endDateInput) endDateInput.setAttribute("min", today);
        }
    
        // âœ… Ø¹Ø±Ø¶ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        function displayFileName(input, previewId) {
            let previewContainer = document.getElementById(previewId);
            if (!previewContainer) return;
    
            previewContainer.innerHTML = "";
    
            if (input.files.length > 0) {
                previewContainer.style.display = "block";
                Array.from(input.files).forEach(file => {
                    let fileItem = document.createElement("div");
                    fileItem.style.display = "flex";
                    fileItem.style.alignItems = "center";
                    fileItem.style.marginTop = "5px";
    
                    let fileIcon = document.createElement("span");
                    fileIcon.innerHTML = "ğŸ“„";
                    fileIcon.style.marginRight = "8px";
    
                    let fileName = document.createElement("span");
                    fileName.textContent = file.name;
    
                    fileItem.appendChild(fileIcon);
                    fileItem.appendChild(fileName);
                    previewContainer.appendChild(fileItem);
                });
            } else {
                previewContainer.style.display = "none";
            }
        }
    
        // âœ… Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        function initializeFileUploadListeners() {
            let logoInput = document.getElementById('id_logo');
            let attachmentsInput = document.getElementById('id_attachments');
    
            if (logoInput) {
                logoInput.addEventListener("change", function() {
                    displayFileName(this, 'logo-preview');
                });
            }
    
            if (attachmentsInput) {
                attachmentsInput.addEventListener("change", function() {
                    displayFileName(this, 'attachments-preview');
                });
            }
        }
    
    </script>
        
</body>
</html>